# HTML编辑器拼写检查模块设计文档

## 1. 概述

拼写检查模块为HTML编辑器提供了检查文本内容中拼写错误的功能。该模块采用面向接口编程和依赖注入原则，具有高度的可扩展性和灵活性。

## 2. 架构设计

拼写检查功能采用了清晰的分层设计，主要组件如下：

### 2.1 主要组件

```
+---------------------+      +---------------------+
|  SpellCheckCommand  |----->|    ISpellChecker    |
|     (命令实现)       |      |    (检查器接口)      |
+---------------------+      +---------------------+
          |                           ^
          |                           |
          v                           |
+---------------------+     +----------------------+
| SpellErrorReporter  |     |  DefaultSpellChecker |
|    (报告器接口)      |     |    (默认检查实现)     |
+---------------------+     +----------------------+
          ^
          |
+---------+-----------+
|   ConsoleReporter   |
|  FileReporter 等   |
+---------------------+
```

### 2.2 核心接口

1. **ISpellChecker**: 拼写检查器接口，定义了检查文本的标准方法
   - 方法: `check_text(text: str) -> List[SpellError]`

2. **SpellErrorReporter**: 错误报告接口，定义了展示错误的标准方法
   - 方法: `report_errors(errors: List[Dict[str, Any]]) -> None`

3. **SpellCheckCommand**: 命令模式实现，协调检查器和报告器完成拼写检查任务
   - 方法: `execute() -> bool`

### 2.3 数据模型

**SpellError**: 表示一个拼写错误的数据类，包含以下信息：
- `wrong_word`: 错误的单词
- `suggestions`: 建议的正确拼写列表
- `context`: 错误单词的上下文
- `start`: 错误在文本中的起始位置
- `end`: 错误在文本中的结束位置

## 3. 详细设计

### 3.1 拼写检查流程

1. 用户触发拼写检查命令（SpellCheckCommand）
2. 命令从HTML模型的根节点开始递归遍历所有元素
3. 对每个元素的文本内容，使用注入的拼写检查器（ISpellChecker实现）检查拼写错误
4. 收集所有发现的拼写错误，并记录它们的位置和上下文信息
5. 使用注入的错误报告器（SpellErrorReporter实现）展示检查结果

### 3.2 设计原则

- **依赖注入原则**: SpellCheckCommand不直接依赖具体实现，而是通过构造函数接收接口对象
- **开放封闭原则**: 可以扩展新的检查器和报告器，而不修改命令类
- **单一职责原则**: 检查逻辑和报告逻辑分离到不同的类中
- **接口隔离原则**: 接口设计简洁，只包含必要的方法

### 3.3 扩展性设计

该架构允许多种扩展：

1. **多种拼写检查器实现**:
   - 默认实现: 使用内置字典和简单算法
   - 可扩展为: 第三方库集成、在线API检查、特定领域词典等

2. **多种报告方式**:
   - 控制台报告: 直接在命令行显示
   - 文件报告: 将结果保存到文件
   - 可扩展为: GUI界面展示、HTML报告、数据库存储等

## 4. 使用示例

### 4.1 基本使用

```python
# 创建HTML模型
model = HtmlModel()

# 创建并执行默认的拼写检查命令
cmd = SpellCheckCommand(model)
cmd.execute()  # 输出到控制台
```

### 4.2 自定义检查器和报告器

```python
# 创建自定义检查器和报告器
custom_checker = MyCustomSpellChecker()
file_reporter = FileReporter("spell_check_result.txt")

# 创建并执行自定义的拼写检查命令
cmd = SpellCheckCommand(model, checker=custom_checker, reporter=file_reporter)
cmd.execute()  # 输出到文件
```

## 5. 未来扩展

1. **实时检查**: 在用户编辑时实时检查拼写错误
2. **自动纠正**: 提供自动纠正建议的功能
3. **多语言支持**: 扩展为支持多种语言的拼写检查
4. **用户词典**: 允许用户添加自定义词典
5. **语法检查**: 扩展为支持基本的语法检查功能
